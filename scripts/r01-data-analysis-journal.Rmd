---
title: "Vietnam FoF Survey Analysis - Journal"
author: "mz"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
  number_sections: yes
toc: yes
toc_depth: 3
html_document: default
bibliography: "../misc/vn-lit.bib"
---
  
  ```{r "setup", include=FALSE}
## this is to set up the main folder as the root
## although this doesnot work for the YAML designations e.g. bibliography, css files etc..:(
require("knitr")
# opts_knit$set(root.dir = "/home/mz/Documents/Copy/Dropbox/analysis/Vietnam/VietnamSurvey")
opts_knit$set(root.dir = "C:/Users/sfos0247/Dropbox/analysis/Vietnam/VietnamSurvey")
```


```{r "load data", include=FALSE}
# has to be in separate chunk from setup!
#load("data-old/working-copy.RData")
```

# Monday 23.10.2017 

Start checking new data.

Asked by GL to do a quick first trawl of the dataset. 

Move previous data into `data-old` folder start new journal - v.2


### Updated dir structure:

`*` indicate the folders and all their contents are hidden/non-public material. 
<!-- use tree /f /a > tree.txt to get output below -->
```
VietnamSurvey/
|   .gitignore
|   .Rhistory
|   VietnamSurvey.Rproj
|   
+---data/*
|   |   
|   \---data-raw/
|       +---DATA/
|       |   +---Excel/
|       |   |       Section_A-G.xls
|       |   |       Section_B.xls
|       |   |       Section_C.xls
|       |   |       Section_G3.xls
|       |   |       Section_H_K.xls
|       |   |       
|       |   \---Stata/
|       |           Section_A-G.dta
|       |           Section_B.dta
|       |           Section_C.dta
|       |           Section_G3.dta
|       |           Section_H_K.dta
|       |           
|       +---REPORT/
|       |       OIPA Farming Survey_IPPM Report_20170411.docx
|       |       
|       \---TOOLS/
|               OIPA_FoF Farming Quest_Eng_final_20161220.docx
|               OIPA_FoF Farming Quest_Vie_final_20161220.docx
|               
+---misc/
|       style.css
|       style.docx
|       vn-lit.bib
|       
+---old/*
|   +---data-old/*
|   |   |   full_data_v1_no_dup.dta
|   |   |   full_data_v1_no_dup_stata-12-11.dta
|   |   |   updated-copy.RData
|   |   |   working-copy.RData
|   |   |   
|   |   \---RawData/*
|   |           full_data_v1_no_dup.dta
|   |           OIPA_FoF Farming Quest_Eng_final_20161220.docx
|   |           OIPA_IPPM ToR for Survey in TB & VP Dec2016_final.pdf
|   |           
|   +---reports-old/*
|   |       r00-survey-variable-list-originals-only.pdf
|   |       r00-survey-variable-list.pdf
|   |       r01-data-analysis-journal-v01.pdf
|   |       r02-survey-issues.pdf
|   |       r03-first-cut.html
|   |       
|   \---scripts-old/*
|           00-my-functions.R 
|           00-scratchpad.R
|           01-data-import.R
|           02-new-variables.R
|           r00-survey-variable-list-originals-only.Rmd
|           r00-survey-variable-list.Rmd
|           r01-data-analysis-journal.pdf
|           r01-data-analysis-journal.Rmd
|           r02-survey-issues.docx
|           r02-survey-issues.Rmd
|           r03-first-cut.Rmd
|           
+---reports/*
\---scripts
        01-data-import.R
        r01-data-analysis-journal.Rmd
        style.docx
```


# Tuesday 24.10.2017 

* Clean up old stuff, now celar project
* Start import of data - `.dta` version
* Import Section_A-G.dta as `ds.1` 148 variables, 413 cases


# Thursday 26.10.2017 

* Import all 5 stata files, all 5 excel files and old stata file and compare number of cases


# Friday 27.10.2017 

* continue with checking three versions of data for missing cases. and write up.

After checks final import is based on:
* new stata files;
* removing hh member moved away 122-25 in section C 
* Saved into `tmp.clean.import.RData`
* `01-data-import.R` is finished = one off

Now start working on `02-data-clean.R`:

* merge into 3 tables
* add unique identifiers 
* this is where i Noticed Section B (hh menmbers) who are residents - there are actually 414 of them, so one too many...

# Monday 30.10.2017

* clean up plot table and add hh ids and unique identifiers. 
* 01-data-import is done
* 02-clean-data consolidates all files into 3 datasets in one RData file (`clean.RData`)


# Sunday 5.11.2017

* prepare variable list: `r00-survey-variable-list.Rmd`
* a few var (g19, g20) have unknown characters in descriptions, clean up in 02-data-clean
* do tables for all three datasets. 
* in ds.membr one var (mcode) has no description


Then the first trawl of the data: `r03-first-cut.Rmd`

* OK, table and plotting funcitons seem to be still working OK for nominal, just tweak for ds.hohh 
* If I add measurement type to the variable list, nominal and interval, i can maybe automate this more
* OK, semi automated now, but need to deal with missing values. tomorrow. 

# Monday 6.11.2017

Fix tables in first trawl

* Make sure missing values are labeled as such (in nominal tables)
* Make sure missing values in interval variables don't mess up the tables eiter (e.g. if one province has them and other doesnt)
* Make sure plots of interval variables also don't use missing 101s. 
* and then change the box plots to violin plots cause they're better

* whole section E is not coded properly. Labels need to be added/ 
* then there is the problem of missing horses and other vars with no valid answers.. 
* and the problem if one province has missing all values, but not the other 

More issues:

* Then note that there are some 'other' questions that have not been translated (g1119other, g1129other, g1139other)
* H12 and H13 should be main reason, but mulitple reasons are given 
* H15, H17 value 3 not labeled
* H1396, I1, I2, I3, K1, K31, K32, K33, K34, K396  wrong measurement, no labels.


Now have a look at the household member data as well. 

* Prepared household member first cut as well

# Tuesday 7.11.2017

Meeting with SH, GL and KH. Agree that I prepare the methods outline paper in two weeks. 
GL will have a look at the first cut and also try to get out of Long the methodology of the sampling.

# Wednesday 8.11.2017

Attempting clean up of project. 

In this process I note that there are duplicate labels in ds.hohh, which gets picked up by `as.data.frame` converting from  `memisc datasets, which I've never noticed before. Anyway, now I need to fix them manually: 

* Vars `d21`, `d22`, `d23` changed `2 = Agree` to `2 = Disagree`. This seems obviously to be a typo. Update `02-data-clean.R` with these. 

Funviton generalisation@

* FunNominal = table any combination of variables from any data set


# Monday 30.4.

Reboot.

# Tuesday 2.10.

Actually reboot here - these get a separate file, `r04-clarificaiton-questions.Rmd`, so look there for most up to date version. 

Questions for clarificaiton of the sampling procedure based on the Report. 

In the report you say: "The first condition was that households were active in farming activities in 2016 and then ranked them along with the size of farming."

1. Why did you rank them? 

2. Did you use the ranking in the sampling process - if so, how?

3. Was the selection of the households done by the communal admistrators? 

4. Was there a list of eligible households? How were they sampled?

In the report you go on to say: "The second condition to choose a representative for each selected household was that such a representative person was actively involved in farming work (doing the work directly) or decisively involved in investment for farming."

4. Was the sampling of households and choice of representative in each household done at the same time?

5. Was the respondent in each household decided in the field?

6. What if there were two respondents that fit this criteria, how did you decide between them?

In the report you say: "there were few people aged 30-50 to do farming, as they were doing some non-agricultural jobs (such as self-employed house constructors, and workers at foreign-invested factories)"

7. Does that mean that if someone was also some non-agricultural jobs, did you exclude them from the survey?

8. Does this mean that all respondents in the survey were doing only farming work?

9. Was this known before going into the field - did you know if heads of households were doing non-agricultural jobs before the interviews or did you find out during the interview and exclude them then?

10. Was there any difference in the sampling procedure of households between the two provinces?

11. Was there any difference in the sampling procedure of the respondents between the two provinces?

12. Did the following organisations help in the selection of households and respondents: The Vietnamese Association of the Elderly, the Farmer's Union, Vienam Women's Union? What was their role?

13. The average household size (including members that have migrated) is 3.1 in Thai Binh and 4.6 in Vinh Phuc. Is that what you would expect? If not, why the discrepancy?

14. The migration rates (household members not living in the household) are higher in Thai Bing (7 %) than in Vinh Phuc (10 %). Is that what you would expect?





<!--
  RANDOM COMMENTS, TO DO, KEEP FOR LATER..
TODO - a 'make file, that runs all the stuff in one go. 
TODO - missing values in table and chart
-->


<!--
rmarkdown::render("scripts/r01-data-analysis-journal.Rmd", output_format = "pdf_document", output_dir = "reports")
-->